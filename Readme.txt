　GPS ログや手書きのGPX ファイル（カシミール3D、ヤマレコのヤマプラ、らくルート、その他で作ったGPX ファイル）のルートを、自分の速度で歩く時のコースタイムを見積るツール（プログラム）です。ブラウザ上で動き、元の GPX ファイルは読み取るだけで何の変更もしません。

　ルートを KML ファイルに出力して国土地理院の地図で表示し、それをダウンロードすればルートの地図も簡単に作れます。
　コースタイムは距離と傾斜レンジごとの速度から求めており、標高は地理院地図の10mメッシュのデータをダウンロードしますので、GPX ファイルに標高データが無くても動きます。
　GPS ログ集計ツール（ https://github.com/guchi999/GpxAnalize ）を使って幾つかの山行記録を集計し、傾斜レンジごとの速度を決めればコースタイムの見積もりも実情に近くなると思います。


（1）基本動作

　画面に GPX ファイルをドロップするか、ボタンを押してファイルを選択して入力ください。ルートの地図が表示され、合計時間、総距離、累積標高が出ます。
　地図はマウスのホイールか地図上のボタンで縮尺が変えられ、ドラッグ(マウスのボタンを押したまま移動)して移動できます。

　地図上でマウスをクリックすると、クリックした地点に一番近いルート上のポイントにマーカーが追加され、順ルート、逆ルートのコースタイムが出ます。
　マーカーを追加すると「＠マーカー名称」の中央のボックスにリストが表示されます。この時のマーカーの名称はクリック毎の連番で、上からスタート地点に近い順に並びます。
　マーカーを追加する順序に制約はなく、幾つでも追加できます。

　マーカーを消すには、消したいマーカーをクリックします。リストは自動的に変わります。
　スタート/ゴール、および各マーカーの名称は、「＠マーカー名称」のボックス内で変えられます。変えた名称は次にマーカーを追加するとコースタイムに反映されます。最後のマーカーは変更できないので、適当に1つ余分なマーカーを追加/削除してください。

　「区間距離の表示」は「する」を選択するとコースタイムに区間距離が表示されます。選択の変えてマーカーを追加/削除すると表示が変わります。

　別のルートを見る時は、そのまま次のファイルを入力すればマーカーはリセットされます。


（2）KML ファイル出力

　「出力」を押すと、マーカー付きの KML ファイルがダウンロードフォルダに出力されます。KMLファイルは元のGPXファイルのデータを約10m間隔で間引いており、データポイントの数がGPXファイルより少ない場合があります。また、KMLファイルの標高データは国土地理院のDEM10B（約10mメッシュ）の標高データになっており、元のGPXファイルとは異なる場合があります。 
  ファイルの名前は変えられます。

　このKML ファイルを地理院地図に入力すればルートの地図が作れます。
　「マーカーのサイズ」は地理院地図で表示されるマーカーのサイズで、ルート地図を作るときに見やすくするために使います。地理院地図で示されるマーカーは表示されているマーカーとは異なります。


（3）速度設定

　速度は表の値で変えられます。[再表示] ボタンを押すと変えた値でコースタイムが表示されます。
　値を変えても立ち上げる毎に元の設定値になります。毎回、値を変えるのは面倒なので、ソースコードの7行目からの値を変えて上書き保存すれば、次からは変更した値で立ち上がります。
　保存するときは、文字コードをUTF8(BOMなし)で保存してください。

UpSpd1～UpSpd4 が上り速度（km/h)、DnSpd1～ DnSpd4 が下り速度です。

const UpSpd1 = 3.15, DnSpd1 = 3.53;
const UpSpd2 = 1.96, DnSpd2 = 2.73;
const UpSpd3 = 1.04, DnSpd3 = 1.79;
const UpSpd4 = 0.62, DnSpd4 = 1.19;

　また、傾斜（昇降値）の範囲も、11行目からの各定数で変えられます。
　UpRng1～UpRng3 が上り、DnRng1～DnRng3 が下りです。下りの数字のマイナス符号は必須です。

const UpRng1 = 20, DnRng1 = -30;
const UpRng2 = 40, DnRng2 = -50;
const UpRng3 = 80, DnRng3 = -80;

